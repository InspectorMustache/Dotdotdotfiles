# function to check in what kind of terminal we are
function is_pts() {
    tstyle=$(tty)
    if [[ ${tstyle:5:3} == pts ]];then
        return 0
    else
        return 1
    fi
}

# simple shorthand for combining pacman and cower searches
paccow() {
    pacman -Ss $*
    cower -s --sort=votes $*
}

# hacky function to keep a HDD from spinning down
live() {
    while true; do
        dd bs=8 count=1 if=/dev/urandom of=/tmp/.live &>/dev/null
        cp /tmp/.live ${1}
        sleep .5
        rm ${1}/.live
        echo -e 'tick'
        sleep 300
        echo -ne 'tock'
    done
}

# functions to ring the terminal bell on longer tasks, see zshrc
zbell_begin() {
	zbell_timestamp=$EPOCHSECONDS
	zbell_lastcmd=$1
}

zbell_end() {
	ran_long=$(( $EPOCHSECONDS - $zbell_timestamp >= 15 ))
    zbell_lastcmd_base=$(expr match "$zbell_lastcmd" '\([a-zA-z0-9]*\)')

	if [[ ! $zbell_lastcmd_base = $EDITOR ]] && (( ran_long )); then
		print -n "\a"
	fi
}

# precmd and preexec functions: basically what happens before the prompt is
# made available
function precmd {
    zbell_end
    vcs_info
    print -Pn "\e]0;Ter--[ %c ]--mite\a"
}

function preexec {
    zbell_begin
    printf "\033]0;%s\a" "Ter--{ $1 }--mite"
}

# vim: set filetype=zsh:
